{"ast":null,"code":"'use client';\n\nimport { useFloating, useRole, useDismiss, useListNavigation, useInteractions } from '../../../node_modules/@floating-ui/react/dist/floating-ui.react.js';\nimport { useState } from 'react';\nimport { flushSync } from 'react-dom';\nimport { useComboboxId, useComboboxIdDispatch } from './ComboboxIdContext.js';\nimport { autoUpdate, flip, size } from '../../../node_modules/@floating-ui/dom/dist/floating-ui.dom.js';\nimport { offset } from '../../../node_modules/@floating-ui/core/dist/floating-ui.core.js';\nconst useFloatingCombobox = _ref => {\n  let {\n    listRef\n  } = _ref;\n  const [open, setOpen] = useState(false);\n  const {\n    activeIndex\n  } = useComboboxId();\n  const dispatch = useComboboxIdDispatch();\n  // floating UI\n  const {\n    refs,\n    floatingStyles,\n    context\n  } = useFloating({\n    open,\n    onOpenChange: newOpen => {\n      if (!newOpen) dispatch?.({\n        type: 'SET_ACTIVE_INDEX',\n        payload: 0\n      });\n      flushSync(() => {\n        if (refs.floating.current && !newOpen) {\n          refs.floating.current.scrollTop = 0;\n        }\n        setTimeout(() => {\n          setOpen(newOpen);\n        }, 1);\n      });\n    },\n    whileElementsMounted: (reference, floating, update) => {\n      autoUpdate(reference, floating, update);\n      return () => {\n        floating.scrollTop = 0;\n      };\n    },\n    middleware: [flip({\n      padding: 10\n    }), size({\n      apply(_ref2) {\n        let {\n          rects,\n          elements\n        } = _ref2;\n        requestAnimationFrame(() => {\n          Object.assign(elements.floating.style, {\n            width: `calc(${rects.reference.width}px - calc(var(--fds-spacing-2) * 2))`,\n            maxHeight: `200px`\n          });\n        });\n      }\n    }), offset(10)]\n  });\n  const role = useRole(context, {\n    role: 'listbox'\n  });\n  const dismiss = useDismiss(context);\n  const listNav = useListNavigation(context, {\n    listRef,\n    activeIndex,\n    virtual: true,\n    scrollItemIntoView: true,\n    enabled: open,\n    focusItemOnHover: true,\n    onNavigate: index => {\n      dispatch?.({\n        type: 'SET_ACTIVE_INDEX',\n        payload: index || 0\n      });\n    }\n  });\n  const {\n    getReferenceProps,\n    getFloatingProps,\n    getItemProps\n  } = useInteractions([role, dismiss, listNav]);\n  return {\n    open,\n    setOpen,\n    activeIndex,\n    refs,\n    floatingStyles,\n    context,\n    getReferenceProps,\n    getFloatingProps,\n    getItemProps\n  };\n};\nexport { useFloatingCombobox };","map":{"version":3,"names":["useFloating","useRole","useDismiss","useListNavigation","useInteractions","useState","flushSync","useComboboxId","useComboboxIdDispatch","autoUpdate","flip","size","offset","useFloatingCombobox","_ref","listRef","open","setOpen","activeIndex","dispatch","refs","floatingStyles","context","onOpenChange","newOpen","type","payload","floating","current","scrollTop","setTimeout","whileElementsMounted","reference","update","middleware","padding","apply","_ref2","rects","elements","requestAnimationFrame","Object","assign","style","width","maxHeight","role","dismiss","listNav","virtual","scrollItemIntoView","enabled","focusItemOnHover","onNavigate","index","getReferenceProps","getFloatingProps","getItemProps"],"sources":["/Users/simondreyer/CascadeProjects/search-interface/node_modules/@digdir/designsystemet-react/dist/esm/components/form/Combobox/useFloatingCombobox.js"],"sourcesContent":["'use client';\nimport { useFloating, useRole, useDismiss, useListNavigation, useInteractions } from '../../../node_modules/@floating-ui/react/dist/floating-ui.react.js';\nimport { useState } from 'react';\nimport { flushSync } from 'react-dom';\nimport { useComboboxId, useComboboxIdDispatch } from './ComboboxIdContext.js';\nimport { autoUpdate, flip, size } from '../../../node_modules/@floating-ui/dom/dist/floating-ui.dom.js';\nimport { offset } from '../../../node_modules/@floating-ui/core/dist/floating-ui.core.js';\n\nconst useFloatingCombobox = ({ listRef }) => {\n    const [open, setOpen] = useState(false);\n    const { activeIndex } = useComboboxId();\n    const dispatch = useComboboxIdDispatch();\n    // floating UI\n    const { refs, floatingStyles, context } = useFloating({\n        open,\n        onOpenChange: (newOpen) => {\n            if (!newOpen)\n                dispatch?.({ type: 'SET_ACTIVE_INDEX', payload: 0 });\n            flushSync(() => {\n                if (refs.floating.current && !newOpen) {\n                    refs.floating.current.scrollTop = 0;\n                }\n                setTimeout(() => {\n                    setOpen(newOpen);\n                }, 1);\n            });\n        },\n        whileElementsMounted: (reference, floating, update) => {\n            autoUpdate(reference, floating, update);\n            return () => {\n                floating.scrollTop = 0;\n            };\n        },\n        middleware: [\n            flip({ padding: 10 }),\n            size({\n                apply({ rects, elements }) {\n                    requestAnimationFrame(() => {\n                        Object.assign(elements.floating.style, {\n                            width: `calc(${rects.reference.width}px - calc(var(--fds-spacing-2) * 2))`,\n                            maxHeight: `200px`,\n                        });\n                    });\n                },\n            }),\n            offset(10),\n        ],\n    });\n    const role = useRole(context, { role: 'listbox' });\n    const dismiss = useDismiss(context);\n    const listNav = useListNavigation(context, {\n        listRef,\n        activeIndex,\n        virtual: true,\n        scrollItemIntoView: true,\n        enabled: open,\n        focusItemOnHover: true,\n        onNavigate: (index) => {\n            dispatch?.({ type: 'SET_ACTIVE_INDEX', payload: index || 0 });\n        },\n    });\n    const { getReferenceProps, getFloatingProps, getItemProps } = useInteractions([role, dismiss, listNav]);\n    return {\n        open,\n        setOpen,\n        activeIndex,\n        refs,\n        floatingStyles,\n        context,\n        getReferenceProps,\n        getFloatingProps,\n        getItemProps,\n    };\n};\n\nexport { useFloatingCombobox };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}